<!DOCTYPE project>
<project name="celesta" default="jar">
	<target name="javacc">
		<echo>Compiling Celesta parser</echo>
		<javacc target="src/ru/curs/celesta/score/celestasql.jj" outputdirectory="src/ru/curs/celesta/score/" javacchome="javacc-5.0" />
	</target>
	<target name="compile" depends="javacc">
		<echo>Compile the source files</echo>
		<javac destdir="build/classes" encoding="UTF-8">
			<classpath>
				<pathelement path="lib/jython.jar" />
			</classpath>
			<src>
				<pathelement path="src" />
			</src>
		</javac>
		<copy tofile="build/classes/ru/curs/celesta/score/celesta.sql" file="src/ru/curs/celesta/score/celesta.sql" />
	</target>
	<target name="jar" depends="compile">
		<echo>Building the jar file</echo>
		<jar destfile="build/celesta.jar" filesetmanifest="merge">
			<fileset dir="build/classes" />
			<zipfileset src="lib/sqljdbc4.jar" excludes="META-INF/MSFTSIG.*" />
			<zipfileset src="lib/jython.jar" />
			<manifest>
				<attribute name="Main-Class" value="ru.curs.celesta.Celesta" />
			</manifest>
		</jar>
	</target>
</project>